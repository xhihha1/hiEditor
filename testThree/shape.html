<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - collada - kinematics</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="../drawingTool/common/thirdparty/threejs/main.css">
		<script src='../drawingTool/common/thirdparty/threejs/three.js'></script>
		<script src="../drawingTool/common/thirdparty/threejs/controls/OrbitControls.js"></script>
		<script src='../drawingTool/common/thirdparty/threejs/libs/stats.min.js'></script>
		<script src='../drawingTool/common/thirdparty/threejs/libs/tween.umd.js'></script>
		<script src='../drawingTool/common/thirdparty/threejs/loaders/ColladaLoader.js'></script>
	</head>
	<body>
		<div id="info">
			
		</div>

		<script>
			
			let container, stats;

			let camera, scene, renderer, controls;
			let particleLight;
			let dae;

			let kinematics;
			let kinematicsTween;
			const tweenParameters = {};



			function init() {

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
				camera.position.set( 10, 10, 10 );

				scene = new THREE.Scene();

				// Grid

				const grid = new THREE.GridHelper( 20, 20, 0x888888, 0x444444 );
				scene.add( grid );

				// Add the COLLADA

				// scene.add( dae );

				particleLight = new THREE.Mesh( new THREE.SphereGeometry( 4, 8, 8 ), new THREE.MeshBasicMaterial( { color: 0xffffff } ) );
				scene.add( particleLight );

				// Lights

				const light = new THREE.HemisphereLight( 0xffeeee, 0x111122 );
				scene.add( light );

				const pointLight = new THREE.PointLight( 0xffffff, 0.3 );
				particleLight.add( pointLight );

				renderer = new THREE.WebGLRenderer();
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				container.appendChild( renderer.domElement );

				stats = new Stats();
				container.appendChild( stats.dom );

				//
				const length = 5, width = 3;
				const shape = new THREE.Shape();
				shape.moveTo( 0,0 );
				// shape.lineTo( 0, 5 );
				// shape.lineTo( 5, 5 );
				// shape.lineTo( 5, 0 );
				// shape.lineTo( 0, 0 );
				shape.lineTo( 0, 5 );
				shape.lineTo( 5, 10 );
				shape.lineTo( -5, 10 );
				shape.lineTo( -3, 2 );

				const x = 0, y = 0;
				const heartShape = new THREE.Shape();
				heartShape.moveTo( x + 5, y + 5 );
				heartShape.bezierCurveTo( x + 5, y + 5, x + 4, y, x, y );
				heartShape.bezierCurveTo( x - 6, y, x - 6, y + 7,x - 6, y + 7 );
				heartShape.bezierCurveTo( x - 6, y + 11, x - 3, y + 15.4, x + 5, y + 19 );
				heartShape.bezierCurveTo( x + 12, y + 15.4, x + 16, y + 11, x + 16, y + 7 );
				heartShape.bezierCurveTo( x + 16, y + 7, x + 16, y, x + 10, y );
				heartShape.bezierCurveTo( x + 7, y, x + 5, y + 5, x + 5, y + 5 );
				// const geometry = new THREE.ShapeGeometry( heartShape );

				const extrudeSettings = {
					steps: 2,
					depth: 5,
					bevelEnabled: false,
					bevelThickness: 1,
					bevelSize: 1,
					bevelOffset: 0,
					bevelSegments: 1
				};

				

				const geometry = new THREE.ExtrudeGeometry( shape, extrudeSettings );
				// const geometry = new THREE.ExtrudeGeometry( heartShape, extrudeSettings );
				const material = new THREE.MeshBasicMaterial( { color: 0x156289 } );
				const mesh = new THREE.Mesh( geometry, material ) ;
				scene.add( mesh );

				const wireframe = new THREE.WireframeGeometry( geometry );
				const line = new THREE.LineSegments( wireframe );
				console.log(line.material)
				line.material.color = new THREE.Color('#FFFFFF')
				line.material.depthTest = false;
				line.material.opacity = 0.25;
				line.material.transparent = true;
				scene.add( line );

				window.addEventListener( 'resize', onWindowResize );

				// add OrbitControls
				controls = new THREE.OrbitControls(camera, renderer.domElement);
				controls.minDistance = 10;
				controls.maxDistance = 1000;
				controls.maxPolarAngle = Math.PI / 2;
				// controls.addEventListener('change', function (event) {
				// 	renderer.render(scene, camera);
				// }.bind(this));
				controls.update();
			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			//

			function animate() {

				requestAnimationFrame( animate );

				render();
				stats.update();
				
			}

			function render() {

				const timer = Date.now() * 0.0001;

				// camera.position.x = Math.cos( timer ) * 20;
				// camera.position.y = 10;
				// camera.position.z = Math.sin( timer ) * 20;

				camera.lookAt( 0, 5, 0 );

				particleLight.position.x = Math.sin( timer * 4 ) * 3009;
				particleLight.position.y = Math.cos( timer * 5 ) * 4000;
				particleLight.position.z = Math.cos( timer * 4 ) * 3009;
				controls.update();
				renderer.render( scene, camera );

			}

			init();
			animate();
		</script>

	</body>
</html>
